<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="A modern Fortran library for Astrodynamics">
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>hybrj1 &ndash; fortran-astrodynamics-toolkit</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">fortran-astrodynamics-toolkit </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>hybrj1
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.2% of total for procedures.">23 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/minpack_module.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/minpack_module.f90.html'>minpack_module.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/minpack_module.html'>minpack_module</a></li>
            <li class="breadcrumb-item active" aria-current="page">hybrj1</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/hybrj1.html#src">hybrj1</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine hybrj1(fcn, n, x, fvec, fjac, ldfjac, tol, info, wa, lwa)  
</h2>
    

    <p>the purpose of hybrj1 is to find a zero of a system of
n nonlinear functions in n variables by a modification
of the powell hybrid method. this is done by using the
more general nonlinear equation solver hybrj. the user
must provide a subroutine which calculates the functions
and the jacobian.</p>
<p>the subroutine statement is</p>
<p>subroutine hybrj1(fcn,n,x,fvec,fjac,ldfjac,tol,info,wa,lwa)</p>
<p>where</p>
<p>fcn is the name of the user-supplied subroutine which
    calculates the functions and the jacobian. fcn must
    be declared in an external statement in the user
    calling program, and should be written as follows.</p>
<div class="codehilite"><pre><span></span><code><span class="nv">subroutine</span><span class="w"> </span><span class="nv">fcn</span><span class="ss">(</span><span class="nv">n</span>,<span class="nv">x</span>,<span class="nv">fvec</span>,<span class="nv">fjac</span>,<span class="nv">ldfjac</span>,<span class="nv">iflag</span><span class="ss">)</span>
<span class="nv">integer</span><span class="w"> </span><span class="nv">n</span>,<span class="nv">ldfjac</span>,<span class="nv">iflag</span>
<span class="nv">real</span><span class="ss">(</span><span class="nv">wp</span><span class="ss">)</span><span class="w"> </span><span class="nv">x</span><span class="ss">(</span><span class="nv">n</span><span class="ss">)</span>,<span class="nv">fvec</span><span class="ss">(</span><span class="nv">n</span><span class="ss">)</span>,<span class="nv">fjac</span><span class="ss">(</span><span class="nv">ldfjac</span>,<span class="nv">n</span><span class="ss">)</span>
<span class="o">----------</span>
<span class="k">if</span><span class="w"> </span><span class="nv">iflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nv">calculate</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">functions</span><span class="w"> </span><span class="nv">at</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">and</span>
<span class="k">return</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">vector</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">fvec</span>.<span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">alter</span><span class="w"> </span><span class="nv">fjac</span>.
<span class="k">if</span><span class="w"> </span><span class="nv">iflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="nv">calculate</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">jacobian</span><span class="w"> </span><span class="nv">at</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">and</span>
<span class="k">return</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">matrix</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">fjac</span>.<span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">alter</span><span class="w"> </span><span class="nv">fvec</span>.
<span class="o">---------</span>
<span class="k">return</span>
<span class="k">end</span>

<span class="nv">the</span><span class="w"> </span><span class="nv">value</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">iflag</span><span class="w"> </span><span class="nv">should</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">changed</span><span class="w"> </span><span class="nv">by</span><span class="w"> </span><span class="nv">fcn</span><span class="w"> </span><span class="nv">unless</span>
<span class="nv">the</span><span class="w"> </span><span class="nv">user</span><span class="w"> </span><span class="nv">wants</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">terminate</span><span class="w"> </span><span class="nv">execution</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">hybrj1</span>.
<span class="nv">in</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">case</span><span class="w"> </span><span class="nv">set</span><span class="w"> </span><span class="nv">iflag</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">negative</span><span class="w"> </span><span class="nv">integer</span>.
</code></pre></div>

<p>n is a positive integer input variable set to the number
    of functions and variables.</p>
<p>x is an array of length n. on input x must contain
    an initial estimate of the solution vector. on output x
    contains the final estimate of the solution vector.</p>
<p>fvec is an output array of length n which contains
    the functions evaluated at the output x.</p>
<p>fjac is an output n by n array which contains the
    orthogonal matrix q produced by the qr factorization
    of the final approximate jacobian.</p>
<p>ldfjac is a positive integer input variable not less than n
    which specifies the leading dimension of the array fjac.</p>
<p>tol is a nonnegative input variable. termination occurs
    when the algorithm estimates that the relative error
    between x and the solution is at most tol.</p>
<p>info is an integer output variable. if the user has
    terminated execution, info is set to the (negative)
    value of iflag. see description of fcn. otherwise,
    info is set as follows.</p>
<div class="codehilite"><pre><span></span><code>info = 0   improper input parameters.

info = 1   algorithm estimates that the relative error
           between x and the solution is at most tol.

info = 2   number of calls to fcn with iflag = 1 has
           reached 100*(n+1).

info = 3   tol is too small. no further improvement in
           the approximate solution x is possible.

info = 4   iteration is not making good progress.
</code></pre></div>

<p>wa is a work array of length lwa.</p>
<p>lwa is a positive integer input variable not less than
    (n*(n+13))/2.</p>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-fcn~5"></span>
              procedure(<a href='../interface/fcn_hybrj.html'>fcn_hybrj</a>)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fcn</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n~10"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~30"></span>
              real(kind=wp)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>x</strong>(n)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fvec~7"></span>
              real(kind=wp)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fvec</strong>(n)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fjac~5"></span>
              real(kind=wp)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fjac</strong>(ldfjac,n)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldfjac~5"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>ldfjac</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tol~3"></span>
              real(kind=wp)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>tol</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~4"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>info</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wa~2"></span>
              real(kind=wp)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>wa</strong>(lwa)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwa~2"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwa</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~hybrj1~~CallsGraph Pages: 1 -->
<svg id="prochybrj1CallsGraph" width="333pt" height="276pt"
 viewBox="0.00 0.00 333.00 276.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~hybrj1~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 272)">
<title>proc~~hybrj1~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-272 329,-272 329,4 -4,4"/>
<!-- proc~hybrj1 -->
<g id="proc~~hybrj1~~CallsGraph_node1" class="node">
<title>proc~hybrj1</title>
<polygon fill="none" stroke="black" points="54,-146 0,-146 0,-122 54,-122 54,-146"/>
<text text-anchor="middle" x="27" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50">hybrj1</text>
</g>
<!-- proc~hybrj -->
<g id="proc~~hybrj1~~CallsGraph_node2" class="node">
<title>proc~hybrj</title>
<g id="a_proc~~hybrj1~~CallsGraph_node2"><a xlink:href="../proc/hybrj.html" xlink:title="hybrj">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-146 90,-146 90,-122 144,-122 144,-146"/>
<text text-anchor="middle" x="117" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hybrj</text>
</a>
</g>
</g>
<!-- proc~hybrj1&#45;&gt;proc~hybrj -->
<g id="proc~~hybrj1~~CallsGraph_edge1" class="edge">
<title>proc~hybrj1&#45;&gt;proc~hybrj</title>
<path fill="none" stroke="#000000" d="M54.4,-134C62.39,-134 71.31,-134 79.82,-134"/>
<polygon fill="#000000" stroke="#000000" points="79.92,-137.5 89.92,-134 79.92,-130.5 79.92,-137.5"/>
</g>
<!-- proc~dogleg -->
<g id="proc~~hybrj1~~CallsGraph_node3" class="node">
<title>proc~dogleg</title>
<g id="a_proc~~hybrj1~~CallsGraph_node3"><a xlink:href="../proc/dogleg.html" xlink:title="dogleg">
<polygon fill="#d9534f" stroke="#d9534f" points="234,-146 180,-146 180,-122 234,-122 234,-146"/>
<text text-anchor="middle" x="207" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dogleg</text>
</a>
</g>
</g>
<!-- proc~hybrj&#45;&gt;proc~dogleg -->
<g id="proc~~hybrj1~~CallsGraph_edge2" class="edge">
<title>proc~hybrj&#45;&gt;proc~dogleg</title>
<path fill="none" stroke="#000000" d="M144.4,-134C152.39,-134 161.31,-134 169.82,-134"/>
<polygon fill="#000000" stroke="#000000" points="169.92,-137.5 179.92,-134 169.92,-130.5 169.92,-137.5"/>
</g>
<!-- proc~dpmpar -->
<g id="proc~~hybrj1~~CallsGraph_node4" class="node">
<title>proc~dpmpar</title>
<g id="a_proc~~hybrj1~~CallsGraph_node4"><a xlink:href="../proc/dpmpar.html" xlink:title="dpmpar">
<polygon fill="#d94e8f" stroke="#d94e8f" points="325,-208 270,-208 270,-184 325,-184 325,-208"/>
<text text-anchor="middle" x="297.5" y="-193.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dpmpar</text>
</a>
</g>
</g>
<!-- proc~hybrj&#45;&gt;proc~dpmpar -->
<g id="proc~~hybrj1~~CallsGraph_edge3" class="edge">
<title>proc~hybrj&#45;&gt;proc~dpmpar</title>
<path fill="none" stroke="#000000" d="M125.43,-146.08C135.58,-161.29 155.37,-186.68 180,-197 205.19,-207.55 236.21,-206.69 259.91,-203.53"/>
<polygon fill="#000000" stroke="#000000" points="260.55,-206.97 269.91,-202 259.5,-200.05 260.55,-206.97"/>
</g>
<!-- proc~enorm -->
<g id="proc~~hybrj1~~CallsGraph_node5" class="node">
<title>proc~enorm</title>
<g id="a_proc~~hybrj1~~CallsGraph_node5"><a xlink:href="../proc/enorm.html" xlink:title="enorm">
<polygon fill="#d94e8f" stroke="#d94e8f" points="324.5,-146 270.5,-146 270.5,-122 324.5,-122 324.5,-146"/>
<text text-anchor="middle" x="297.5" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">enorm</text>
</a>
</g>
</g>
<!-- proc~hybrj&#45;&gt;proc~enorm -->
<g id="proc~~hybrj1~~CallsGraph_edge4" class="edge">
<title>proc~hybrj&#45;&gt;proc~enorm</title>
<path fill="none" stroke="#000000" d="M144.06,-123.06C154.96,-119.04 167.89,-115 180,-113 203.68,-109.1 210.31,-109.13 234,-113 242.77,-114.43 251.97,-116.93 260.53,-119.71"/>
<polygon fill="#000000" stroke="#000000" points="259.62,-123.1 270.22,-123.06 261.91,-116.48 259.62,-123.1"/>
</g>
<!-- proc~qform -->
<g id="proc~~hybrj1~~CallsGraph_node6" class="node">
<title>proc~qform</title>
<g id="a_proc~~hybrj1~~CallsGraph_node6"><a xlink:href="../proc/qform.html" xlink:title="qform">
<polygon fill="#d9534f" stroke="#d9534f" points="234,-66 180,-66 180,-42 234,-42 234,-66"/>
<text text-anchor="middle" x="207" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">qform</text>
</a>
</g>
</g>
<!-- proc~hybrj&#45;&gt;proc~qform -->
<g id="proc~~hybrj1~~CallsGraph_edge5" class="edge">
<title>proc~hybrj&#45;&gt;proc~qform</title>
<path fill="none" stroke="#000000" d="M131.37,-121.85C145.66,-108.85 168.53,-88.07 185.18,-72.92"/>
<polygon fill="#000000" stroke="#000000" points="187.75,-75.32 192.8,-66 183.04,-70.14 187.75,-75.32"/>
</g>
<!-- proc~qrfac -->
<g id="proc~~hybrj1~~CallsGraph_node7" class="node">
<title>proc~qrfac</title>
<g id="a_proc~~hybrj1~~CallsGraph_node7"><a xlink:href="../proc/qrfac.html" xlink:title="qrfac">
<polygon fill="#d9534f" stroke="#d9534f" points="234,-188 180,-188 180,-164 234,-164 234,-188"/>
<text text-anchor="middle" x="207" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">qrfac</text>
</a>
</g>
</g>
<!-- proc~hybrj&#45;&gt;proc~qrfac -->
<g id="proc~~hybrj1~~CallsGraph_edge6" class="edge">
<title>proc~hybrj&#45;&gt;proc~qrfac</title>
<path fill="none" stroke="#000000" d="M143.45,-146.15C152.21,-150.33 162.17,-155.08 171.52,-159.54"/>
<polygon fill="#000000" stroke="#000000" points="170.07,-162.73 180.6,-163.88 173.09,-156.41 170.07,-162.73"/>
</g>
<!-- proc~r1mpyq -->
<g id="proc~~hybrj1~~CallsGraph_node8" class="node">
<title>proc~r1mpyq</title>
<g id="a_proc~~hybrj1~~CallsGraph_node8"><a xlink:href="../proc/r1mpyq.html" xlink:title="r1mpyq">
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 180,-24 180,0 234,0 234,-24"/>
<text text-anchor="middle" x="207" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">r1mpyq</text>
</a>
</g>
</g>
<!-- proc~hybrj&#45;&gt;proc~r1mpyq -->
<g id="proc~~hybrj1~~CallsGraph_edge7" class="edge">
<title>proc~hybrj&#45;&gt;proc~r1mpyq</title>
<path fill="none" stroke="#000000" d="M123.71,-121.92C133.46,-102.04 154.74,-61.75 180,-33 180.6,-32.31 181.23,-31.63 181.88,-30.96"/>
<polygon fill="#000000" stroke="#000000" points="184.33,-33.45 189.29,-24.09 179.57,-28.32 184.33,-33.45"/>
</g>
<!-- proc~r1updt -->
<g id="proc~~hybrj1~~CallsGraph_node9" class="node">
<title>proc~r1updt</title>
<g id="a_proc~~hybrj1~~CallsGraph_node9"><a xlink:href="../proc/r1updt.html" xlink:title="r1updt">
<polygon fill="#d9534f" stroke="#d9534f" points="234,-268 180,-268 180,-244 234,-244 234,-268"/>
<text text-anchor="middle" x="207" y="-253.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">r1updt</text>
</a>
</g>
</g>
<!-- proc~hybrj&#45;&gt;proc~r1updt -->
<g id="proc~~hybrj1~~CallsGraph_edge8" class="edge">
<title>proc~hybrj&#45;&gt;proc~r1updt</title>
<path fill="none" stroke="#000000" d="M124.68,-146.08C135.31,-164.84 157.19,-201.75 180,-230 181.68,-232.09 183.52,-234.19 185.4,-236.24"/>
<polygon fill="#000000" stroke="#000000" points="183.27,-239.07 192.74,-243.81 188.29,-234.2 183.27,-239.07"/>
</g>
<!-- proc~dogleg&#45;&gt;proc~dpmpar -->
<g id="proc~~hybrj1~~CallsGraph_edge9" class="edge">
<title>proc~dogleg&#45;&gt;proc~dpmpar</title>
<path fill="none" stroke="#000000" d="M225.48,-146.25C238.42,-155.31 256.23,-167.79 270.79,-177.99"/>
<polygon fill="#000000" stroke="#000000" points="269.15,-181.12 279.35,-183.99 273.17,-175.38 269.15,-181.12"/>
</g>
<!-- proc~dogleg&#45;&gt;proc~enorm -->
<g id="proc~~hybrj1~~CallsGraph_edge10" class="edge">
<title>proc~dogleg&#45;&gt;proc~enorm</title>
<path fill="none" stroke="#000000" d="M234.07,-134C242.28,-134 251.5,-134 260.28,-134"/>
<polygon fill="#000000" stroke="#000000" points="260.31,-137.5 270.31,-134 260.31,-130.5 260.31,-137.5"/>
</g>
<!-- proc~qrfac&#45;&gt;proc~dpmpar -->
<g id="proc~~hybrj1~~CallsGraph_edge11" class="edge">
<title>proc~qrfac&#45;&gt;proc~dpmpar</title>
<path fill="none" stroke="#000000" d="M234.07,-181.89C242.21,-183.73 251.34,-185.79 260.05,-187.76"/>
<polygon fill="#000000" stroke="#000000" points="259.47,-191.22 270,-190.01 261.02,-184.39 259.47,-191.22"/>
</g>
<!-- proc~qrfac&#45;&gt;proc~enorm -->
<g id="proc~~hybrj1~~CallsGraph_edge12" class="edge">
<title>proc~qrfac&#45;&gt;proc~enorm</title>
<path fill="none" stroke="#000000" d="M233.6,-163.85C242.4,-159.67 252.42,-154.92 261.82,-150.46"/>
<polygon fill="#000000" stroke="#000000" points="263.43,-153.57 270.96,-146.12 260.42,-147.25 263.43,-153.57"/>
</g>
<!-- proc~r1updt&#45;&gt;proc~dpmpar -->
<g id="proc~~hybrj1~~CallsGraph_edge13" class="edge">
<title>proc~r1updt&#45;&gt;proc~dpmpar</title>
<path fill="none" stroke="#000000" d="M225.91,-243.86C238.62,-235.24 255.9,-223.52 270.18,-213.84"/>
<polygon fill="#000000" stroke="#000000" points="272.3,-216.63 278.62,-208.12 268.38,-210.84 272.3,-216.63"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">    </span><span class="k">subroutine </span><span class="n">hybrj1</span><span class="p">(</span><span class="n">fcn</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">fvec</span><span class="p">,</span><span class="n">fjac</span><span class="p">,</span><span class="n">ldfjac</span><span class="p">,</span><span class="n">tol</span><span class="p">,</span><span class="n">info</span><span class="p">,</span><span class="n">wa</span><span class="p">,</span><span class="n">lwa</span><span class="p">)</span>

<span class="w">    </span><span class="k">implicit none</span>

<span class="k">    procedure</span><span class="p">(</span><span class="n">fcn_hybrj</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fcn</span>
<span class="w">    </span><span class="kt">integer </span><span class="n">n</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ldfjac</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwa</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="n">tol</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">fvec</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">fjac</span><span class="p">(</span><span class="n">ldfjac</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wa</span><span class="p">(</span><span class="n">lwa</span><span class="p">)</span>

<span class="w">      </span><span class="kt">integer </span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lr</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">maxfev</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">nfev</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">njev</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">nprint</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="n">xtol</span>

<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="mf">0.0_wp</span>

<span class="w">      </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">      </span><span class="c">! check the input parameters for errors.</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">ldfjac</span><span class="o">&gt;=</span><span class="n">n</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">tol</span><span class="o">&gt;=</span><span class="n">zero</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">lwa</span><span class="o">&gt;=</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">13</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="w">         </span><span class="c">! call hybrj.</span>

<span class="w">         </span><span class="n">maxfev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="w">         </span><span class="n">xtol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tol</span>
<span class="w">         </span><span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">         </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">            </span><span class="n">wa</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">         </span><span class="k">enddo</span>
<span class="k">         </span><span class="n">nprint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">         </span><span class="n">lr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
<span class="w">         </span><span class="k">call </span><span class="n">hybrj</span><span class="p">(</span><span class="n">fcn</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">fvec</span><span class="p">,</span><span class="n">fjac</span><span class="p">,</span><span class="n">ldfjac</span><span class="p">,</span><span class="n">xtol</span><span class="p">,</span><span class="n">maxfev</span><span class="p">,</span><span class="n">wa</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">mode</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">factor</span><span class="p">,</span><span class="n">nprint</span><span class="p">,</span><span class="n">info</span><span class="p">,</span><span class="n">nfev</span><span class="p">,</span><span class="n">njev</span><span class="p">,</span><span class="n">wa</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">lr</span><span class="p">,</span><span class="n">wa</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">wa</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">wa</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">wa</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">wa</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">info</span><span class="o">==</span><span class="mi">5</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span>

<span class="w">      </span><span class="k">endif</span>

<span class="k">      end subroutine </span><span class="n">hybrj1</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              fortran-astrodynamics-toolkit
 was developed by Jacob Williams<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>